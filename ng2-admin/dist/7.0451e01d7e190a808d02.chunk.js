webpackJsonp([7],{1591:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(11),i=n(22),r=n(286),o=(n.n(r),n(758)),c=(n.n(o),n(1654)),l=n(1620),d=n(285),u=n(287),m=n(1619);n.d(e,"DsProfileModule",(function(){return p}));var p=(function(){function t(){}return t})();p=__decorate([n.i(a.NgModule)({imports:[s.CommonModule,i.a,r.NgxDatatableModule,o.LaddaModule,u.a,c.a],declarations:[m.a],providers:[l.a,l.b,d.a,d.c]})],p)},1619:function(t,e,n){"use strict";var a=n(0),s=n(26),i=n(136),r=(n.n(i),n(138)),o=n(57),c=n(285),l=n(294),d=n(764),u=n(1620),m=n(77),p=n(33),v=n(192),h=n.n(v);n.d(e,"a",(function(){return f}));var f=(function(){function t(t,e,n,a,s,i,r,o,c){this.injector=t,this.globalState=e,this.appState=n,this.translate=a,this.modal=s,this.auth=i,this.identityApiService=r,this.microserviceConfig=o,this.toastr=c,this.personaSaveInProgress=!1,this.user=this.auth.getAuthUser(),this.userFormData={email:""},this.authEndpoint=this.appState.get("microservices").authentication.paths[this.user.identity.toLowerCase()]}return t.prototype.ngOnInit=function(){var t=this;this.languageChangeSubscriber=this.translate.onLangChange.subscribe((function(e){t.init()})),this.init()},t.prototype.ngOnDestroy=function(){this.languageChangeSubscriber.unsubscribe()},t.prototype.init=function(){var t=this;setTimeout((function(){t.globalState.notifyDataChanged("menu.activeLink",{title:"general.menu.profile"})})),this.auth.fetchUser().subscribe((function(e){t.user&&(t.user.email=e.email,t.userFormData.email=t.user.email)})),this.user&&this.loadPersona()},t.prototype.loadPersona=function(){var t=this,e=l.a.getPersonaUrlPrefix(this.user.identity),n=l.a.getSingular(this.user.identity),a={};a[n+".uuid"]=this.user.identityUuid,this.identityApiService.resource(e).getList(a).subscribe((function(e){e.length>0&&(t.persona=e[0],t.persona.route+="/"+t.persona.uuid)}))},t.prototype.savePersona=function(){var t=this;this.personaSaveInProgress=!0,this.persona.put().subscribe((function(e){h()(t.persona,e),t.toastr.success(t.translate.instant("ds.messages.personaSaveSucceeded"))}),(function(e){t.toastr.error(t.translate.instant("ds.messages.personaSaveFailed"))}),(function(){t.personaSaveInProgress=!1}))},t.prototype.saveUser=function(t){var e=this;this.auth.updateUser(this.userFormData).subscribe((function(n){e.toastr.success(e.translate.instant("ds.messages.identitySaveSucceeded")),e.auth.login(e.authEndpoint,e.user.username,t).finally((function(){})).subscribe((function(t){t&&e.toastr.success(e.translate.instant("ds.messages.tokenUpdateSucceeded"))}),(function(t){e.toastr.error(e.translate.instant("ds.messages.tokenUpdateFailed")+" "+t.message)}))}),(function(t){e.toastr.error(e.translate.instant("ds.messages.identitySaveFailed"))}))},t.prototype.openCredentialsModal=function(){var t=this,e={size:"sm",windowClass:"credentials-modal"};this.credentialsModal=this.modal.open(d.a,e),this.credentialsModal.componentInstance.authEndpoint=this.authEndpoint,this.credentialsModal.componentInstance.username=this.user.username,this.credentialsModal.result.then((function(e){e&&"success"===e.status&&t.saveUser(e.password)}),(function(t){}))},t})();f=__decorate([n.i(a.Component)({selector:"ds-profile",template:n(1680)}),__metadata("design:paramtypes",[a.Injector,m.a,p.a,s.c,r.c,o.a,u.b,c.a,i.ToastsManager])],f)},1620:function(t,e,n){"use strict";var a=n(0),s=n(140),i=(n.n(s),n(285)),r=n(33),o=n(57),c=n(189),l=n(39);n.n(l);n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return u}));var d=(function(t){function e(e){var n=t.call(this,e)||this;return n.restangular=e,n}return __extends(e,t),e})(c.a);d=__decorate([n.i(a.Injectable)(),__param(0,n.i(a.Inject)(i.d)),__metadata("design:paramtypes",[Object])],d);var u=(function(t){function e(e,a,s){var r=t.call(this)||this;r.restangular=e,r.appState=a,r.auth=s;var o=new i.a;return o.name="identities",o.settings=r.appState.get("microservices")[o.name],r.restangular=n.i(i.b)(e,s,o),r}return __extends(e,t),e})(c.a);u=__decorate([n.i(a.Injectable)(),__metadata("design:paramtypes",[s.Restangular,r.a,o.a])],u)},1654:function(t,e,n){"use strict";var a=n(29),s=n(289),i=n(1619);n.d(e,"a",(function(){return o}));var r=[{path:"",component:i.a,canActivate:[s.a],children:[]}],o=a.a.forChild(r)},1680:function(t,e){t.exports='\n<div class="">\n\t<div class="row">\n\t\t<div class="col">\n\t\t\t<form class="card entity-card animated fadeIn">\n\t\t\t\t<div class="card-header">\n\t\t\t\t\t<div class="row justify-content-between">\n\t\t\t\t\t\t<div class="col-sm-6">\n\t\t\t\t\t\t\t<h3 class="card-title" translate>{{\'ds.microservices.entity.property.identity\'}}</h3>\n\t\t\t\t\t\t\t<h4 class="card-subtitle">{{user.username}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-sm-6 mt-3 mt-sm-0">\n\t\t\t\t\t\t\t<ul class="btn-list clearfix">\n\t\t\t\t\t\t\t\t<li class="float-right">\n\t\t\t\t\t\t\t\t\t<button (click)="openCredentialsModal($event)" type="button" class="btn btn-primary btn-with-icon"><i class="ion-edit">{{\'ds.microservices.entity.action.save\' | translate}}</i></button>\n\t\t\t\t\t\t\t\t\t<ng-content select="button.entity-action"></ng-content>\n\t\t\t\t\t\t\t\t\t\x3c!--<button (click)="" type="button" class="btn btn-danger btn-with-icon"><i class="ion-android-delete">{{\'ds.microservices.entity.action.delete\' | translate}}</i></button>--\x3e\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-block entity-body entity-data">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="username">{{ \'ds.microservices.entity.property.username\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="username" name="username" type="text" [(ngModel)]="user.username" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="identity">{{ \'ds.microservices.entity.property.identity\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="identity" name="identity" type="text" [(ngModel)]="user.identity" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="identityUuid">{{ \'ds.microservices.entity.property.identityUuid\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="identityUuid" name="identityUuid" type="text" [(ngModel)]="user.identityUuid" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="email">{{ \'login.email\' | translate }}</label>\n\t\t\t\t\t\t<input id="email" name="email" type="email" [(ngModel)]="userFormData.email" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--<div class="form-group">--\x3e\n\t\t\t\t\t\t\x3c!--<label for="plainPassword">{{ \'login.password\' | translate }}</label>--\x3e\n\t\t\t\t\t\t\x3c!--<input iuserFormData" name="plainPassword" type="password" [(ngModel)]="identityFormData.plainPassword" class="form-control">--\x3e\n\t\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t\t</div>\n\t\t\t</form>\n\n\t\t\t<form *ngIf="persona" class="card entity-card animated fadeIn">\n\t\t\t\t<div class="card-header">\n\t\t\t\t\t<div class="row justify-content-between">\n\t\t\t\t\t\t<div class="col-sm-6">\n\t\t\t\t\t\t\t<h3 class="card-title" translate>Persona</h3>\n\t\t\t\t\t\t\t<h4 class="card-subtitle">{{persona.title | entityTranslate}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-sm-6 mt-3 mt-sm-0">\n\t\t\t\t\t\t\t<ul class="btn-list clearfix">\n\t\t\t\t\t\t\t\t<li class="float-right">\n\t\t\t\t\t\t\t\t\t<button (click)="savePersona($event)" type="button" [disabled]="personaSaveInProgress" [ladda]="personaSaveInProgress" class="btn btn-primary btn-with-icon"><i class="ion-edit">{{\'ds.microservices.entity.action.save\' | translate}}</i></button>\n\t\t\t\t\t\t\t\t\t<ng-content select="button.entity-action"></ng-content>\n\t\t\t\t\t\t\t\t\t\x3c!--<button (click)="" type="button" class="btn btn-danger btn-with-icon"><i class="ion-android-delete">{{\'ds.microservices.entity.action.delete\' | translate}}</i></button>--\x3e\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-block entity-body entity-data">\n\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t<div class="form-group" *ngFor="let item of persona.data | keyValue" [ngSwitch]="item.key">\n\t\t\t\t\t\t\t\t<label [for]="\'data-\' + item.key">{{ (\'ds.microservices.entity.property.\' + item.key) | translate }}</label>\n\t\t\t\t\t\t\t\t<input *ngSwitchDefault [id]="\'data-\' + item.key" [name]="item.key" type="text" [(ngModel)]="persona.data[item.key]" class="form-control" placeholder="">\n\t\t\t\t\t\t\t\t<textarea *ngSwitchCase="\'address\'" [id]="\'data-\' + item.key" [name]="item.key" [(ngModel)]="persona.data[item.key]" class="form-control" placeholder=""></textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>'}});