webpackJsonp([6],{1619:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(0),i=a(9),s=a(20),r=a(298),o=(a.n(r),a(772)),c=(a.n(o),a(1683)),l=a(1649),d=a(297),u=a(299),p=a(1648);a.d(e,"DsProfileModule",(function(){return m}));var m=(function(){function t(){}return t})();m=__decorate([a.i(n.NgModule)({imports:[i.CommonModule,s.a,r.NgxDatatableModule,o.LaddaModule,u.a,c.a],declarations:[p.a],providers:[l.a,l.b,d.a,d.c]})],m)},1628:function(t,e,a){"use strict";var n=a(0),i=a(27),s=a(9),r=a(300),o=a(192),c=a(46);a.d(e,"a",(function(){return l}));var l=(function(){function t(t){this.injector=t,this.pageBreadcrumbData={},this.route=this.injector.get(i.b),this.location=this.injector.get(s.Location),this.staticTranslate=this.injector.get(r.a),this.globalState=this.injector.get(c.a),this.breadcrumbService=this.injector.get(o.a)}return t.prototype.ngOnInit=function(){this.pageTitle&&this.applyPageTitle(),this.setBreadcrumbData()},t.prototype.applyPageTitle=function(t){var e=this,a=t||this.pageTitle;a&&setTimeout((function(){e.globalState.notifyDataChanged("menu.activeLink",{title:a})}))},t.prototype.setBreadcrumbData=function(){this.pageTitle&&(this.pageBreadcrumbData.title=this.pageTitle)},t.prototype.buildBreadcrumb=function(){var t=this.location.path().split("/").slice(2,3).map((function(t){return"path-"+t}));return{title:"string"==typeof this.pageBreadcrumbData.title?this.staticTranslate.instantAll(this.pageBreadcrumbData.title):this.pageBreadcrumbData.title,subtitle:"string"==typeof this.pageBreadcrumbData.subtitle?this.staticTranslate.instantAll(this.pageBreadcrumbData.subtitle):this.pageBreadcrumbData.subtitle,link:this.location.path(),tags:[].concat(t,this.pageBreadcrumbData.tags),routeData:this.route.snapshot.data}},t.prototype.commitBreadcrumb=function(t,e){t||(t=this.buildBreadcrumb()),this.breadcrumbService.push(t,e)},t})();l=__decorate([a.i(n.Component)({}),__metadata("design:paramtypes",[n.Injector])],l)},1648:function(t,e,a){"use strict";var n=a(0),i=a(19),s=a(138),r=(a.n(s),a(140)),o=a(51),c=a(297),l=a(197),d=a(778),u=a(1628),p=a(1649),m=a(46),h=a(28),b=a(198),v=a.n(b);a.d(e,"a",(function(){return g}));var g=(function(t){function e(e,a,n,i,s,r,o,c,l){var d=t.call(this,e)||this;return d.injector=e,d.globalState=a,d.appState=n,d.translate=i,d.modal=s,d.auth=r,d.identityApiService=o,d.microserviceConfig=c,d.toastr=l,d.pageTitle="general.menu.profile",d.personaSaveInProgress=!1,d.user=d.auth.getAuthUser(),d.userFormData={email:""},d.authEndpoint=d.appState.get("microservices").authentication.paths[d.user.identity.toLowerCase()],d}return __extends(e,t),e.prototype.ngOnInit=function(){var e=this;t.prototype.ngOnInit.call(this),this.commitBreadcrumb(),this.languageChangeSubscriber=this.translate.onLangChange.subscribe((function(t){e.init()})),this.init()},e.prototype.ngOnDestroy=function(){this.languageChangeSubscriber.unsubscribe()},e.prototype.init=function(){var t=this;setTimeout((function(){t.globalState.notifyDataChanged("menu.activeLink",{title:"general.menu.profile"})})),this.auth.fetchUser().subscribe((function(e){t.user&&(t.user.email=e.email,t.userFormData.email=t.user.email)})),this.user&&this.loadPersona()},e.prototype.loadPersona=function(){var t=this,e=l.a.getPersonaUrlPrefix(this.user.identity),a=l.a.getSingular(this.user.identity),n={};n[a+".uuid"]=this.user.identityUuid,this.identityApiService.resource(e).getList(n).subscribe((function(e){e.length>0&&(t.persona=e[0],t.persona.route+="/"+t.persona.uuid)}))},e.prototype.savePersona=function(){var t=this;this.personaSaveInProgress=!0,this.persona.put().subscribe((function(e){v()(t.persona,e),t.toastr.success(t.translate.instant("ds.messages.personaSaveSucceeded"))}),(function(e){t.toastr.error(t.translate.instant("ds.messages.personaSaveFailed"))}),(function(){t.personaSaveInProgress=!1}))},e.prototype.saveUser=function(t){var e=this;this.auth.updateUser(this.userFormData).subscribe((function(a){e.toastr.success(e.translate.instant("ds.messages.identitySaveSucceeded")),e.auth.login(e.authEndpoint,e.user.username,t).finally((function(){})).subscribe((function(t){t&&e.toastr.success(e.translate.instant("ds.messages.tokenUpdateSucceeded"))}),(function(t){e.toastr.error(e.translate.instant("ds.messages.tokenUpdateFailed")+" "+t.message)}))}),(function(t){e.toastr.error(e.translate.instant("ds.messages.identitySaveFailed"))}))},e.prototype.openCredentialsModal=function(){var t=this,e={size:"sm",windowClass:"credentials-modal"};this.credentialsModal=this.modal.open(d.a,e),this.credentialsModal.componentInstance.authEndpoint=this.authEndpoint,this.credentialsModal.componentInstance.username=this.user.username,this.credentialsModal.result.then((function(e){e&&"success"===e.status&&t.saveUser(e.password)}),(function(t){}))},e})(u.a);g=__decorate([a.i(n.Component)({selector:"ds-profile",template:a(1707)}),__metadata("design:paramtypes",[n.Injector,m.a,h.a,i.c,r.c,o.a,p.b,c.a,s.ToastsManager])],g)},1649:function(t,e,a){"use strict";var n=a(0),i=a(142),s=(a.n(i),a(297)),r=a(28),o=a(51),c=a(193),l=a(36);a.n(l);a.d(e,"a",(function(){return d})),a.d(e,"b",(function(){return u}));var d=(function(t){function e(e){var a=t.call(this,e)||this;return a.restangular=e,a}return __extends(e,t),e})(c.a);d=__decorate([a.i(n.Injectable)(),__param(0,a.i(n.Inject)(s.d)),__metadata("design:paramtypes",[Object])],d);var u=(function(t){function e(e,n,i){var r=t.call(this)||this;r.restangular=e,r.appState=n,r.auth=i;var o=new s.a;return o.name="identities",o.settings=r.appState.get("microservices")[o.name],r.restangular=a.i(s.b)(e,i,o),r}return __extends(e,t),e})(c.a);u=__decorate([a.i(n.Injectable)(),__metadata("design:paramtypes",[i.Restangular,r.a,o.a])],u)},1683:function(t,e,a){"use strict";var n=a(27),i=a(302),s=a(1648);a.d(e,"a",(function(){return o}));var r=[{path:"",component:s.a,canActivate:[i.a],children:[]}],o=n.a.forChild(r)},1707:function(t,e){t.exports='<h1 class="al-title">{{ pageTitle | translate }}</h1>\n\n<div class="mt-4">\n\t<div class="row">\n\t\t<div class="col">\n\t\t\t<form class="card entity-card animated fadeIn">\n\t\t\t\t<div class="card-header">\n\t\t\t\t\t<div class="row justify-content-between">\n\t\t\t\t\t\t<div class="col-sm-6">\n\t\t\t\t\t\t\t<h3 class="card-title" translate>{{\'ds.microservices.entity.property.identity\'}}</h3>\n\t\t\t\t\t\t\t<h4 class="card-subtitle">{{user.username}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-sm-6 mt-3 mt-sm-0">\n\t\t\t\t\t\t\t<ul class="btn-list clearfix">\n\t\t\t\t\t\t\t\t<li class="float-right">\n\t\t\t\t\t\t\t\t\t<button (click)="openCredentialsModal($event)" type="button" class="btn btn-primary btn-with-icon"><i class="ion-edit">{{\'ds.microservices.entity.action.save\' | translate}}</i></button>\n\t\t\t\t\t\t\t\t\t<ng-content select="button.entity-action"></ng-content>\n\t\t\t\t\t\t\t\t\t\x3c!--<button (click)="" type="button" class="btn btn-danger btn-with-icon"><i class="ion-android-delete">{{\'ds.microservices.entity.action.delete\' | translate}}</i></button>--\x3e\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-block entity-body entity-data">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="username">{{ \'ds.microservices.entity.property.username\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="username" name="username" type="text" [(ngModel)]="user.username" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="identity">{{ \'ds.microservices.entity.property.identity\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="identity" name="identity" type="text" [(ngModel)]="user.identity" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="identityUuid">{{ \'ds.microservices.entity.property.identityUuid\' | translate }}</label>\n\t\t\t\t\t\t<input disabled id="identityUuid" name="identityUuid" type="text" [(ngModel)]="user.identityUuid" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="email">{{ \'login.email\' | translate }}</label>\n\t\t\t\t\t\t<input id="email" name="email" type="email" [(ngModel)]="userFormData.email" class="form-control">\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--<div class="form-group">--\x3e\n\t\t\t\t\t\t\x3c!--<label for="plainPassword">{{ \'login.password\' | translate }}</label>--\x3e\n\t\t\t\t\t\t\x3c!--<input iuserFormData" name="plainPassword" type="password" [(ngModel)]="identityFormData.plainPassword" class="form-control">--\x3e\n\t\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t\t</div>\n\t\t\t</form>\n\n\t\t\t<form *ngIf="persona" class="card entity-card animated fadeIn">\n\t\t\t\t<div class="card-header">\n\t\t\t\t\t<div class="row justify-content-between">\n\t\t\t\t\t\t<div class="col-sm-6">\n\t\t\t\t\t\t\t<h3 class="card-title" translate>Persona</h3>\n\t\t\t\t\t\t\t<h4 class="card-subtitle">{{persona.title | entityTranslate}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-sm-6 mt-3 mt-sm-0">\n\t\t\t\t\t\t\t<ul class="btn-list clearfix">\n\t\t\t\t\t\t\t\t<li class="float-right">\n\t\t\t\t\t\t\t\t\t<button (click)="savePersona($event)" type="button" [disabled]="personaSaveInProgress" [ladda]="personaSaveInProgress" class="btn btn-primary btn-with-icon"><i class="ion-edit">{{\'ds.microservices.entity.action.save\' | translate}}</i></button>\n\t\t\t\t\t\t\t\t\t<ng-content select="button.entity-action"></ng-content>\n\t\t\t\t\t\t\t\t\t\x3c!--<button (click)="" type="button" class="btn btn-danger btn-with-icon"><i class="ion-android-delete">{{\'ds.microservices.entity.action.delete\' | translate}}</i></button>--\x3e\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-block entity-body entity-data">\n\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t<div class="form-group" *ngFor="let item of persona.data | keyValue" [ngSwitch]="item.key">\n\t\t\t\t\t\t\t\t<label [for]="\'data-\' + item.key">{{ (\'ds.microservices.entity.property.\' + item.key) | translate }}</label>\n\t\t\t\t\t\t\t\t<input *ngSwitchDefault [id]="\'data-\' + item.key" [name]="item.key" type="text" [(ngModel)]="persona.data[item.key]" class="form-control" placeholder="">\n\t\t\t\t\t\t\t\t<textarea *ngSwitchCase="\'address\'" [id]="\'data-\' + item.key" [name]="item.key" [(ngModel)]="persona.data[item.key]" class="form-control" placeholder=""></textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-block entity-body entity-data">\n\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t<div class="col-sm-12">\n\t\t\t\t\t\t\t<pre>{{ persona.data | json }}</pre>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>'}});